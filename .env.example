# ============================================
# BUNQ DASHBOARD - SESSION-BASED AUTH
# Environment Configuration v3.0
# ============================================

# ============================================
# SECURITY CREDENTIALS (VERPLICHT!)
# ============================================

# Login username (wachtwoord komt via Docker secret)
BASIC_AUTH_USERNAME=admin

# Docker Swarm secrets (NIET in .env)
# - basic_auth_password
# - flask_secret_key
# - vaultwarden_client_id
# - vaultwarden_client_secret
# - bunq_api_key (alleen als USE_VAULTWARDEN=false)

# ============================================
# VAULTWARDEN CONFIGURATION
# ============================================

# Vaultwarden URL (binnen Docker network)
VAULTWARDEN_URL=http://vaultwarden:80

# Vaultwarden API credentials komen via Docker secrets:
# - vaultwarden_client_id
# - vaultwarden_client_secret

# Naam van het vault item waar je Bunq API key staat
VAULTWARDEN_ITEM_NAME=Bunq API Key

# Enable Vaultwarden (true) of gebruik BUNQ_API_KEY direct (false)
USE_VAULTWARDEN=true

# ============================================
# BUNQ API CONFIGURATION
# ============================================

# Bunq Environment (SANDBOX of PRODUCTION)
BUNQ_ENVIRONMENT=PRODUCTION

# Alleen gebruiken als USE_VAULTWARDEN=false (via Docker secret: bunq_api_key)

# ============================================
# CORS CONFIGURATION
# ============================================

# Toegestane origins voor CORS (komma-gescheiden)
# Vervang met je NAS IP-adres!
# Voorbeelden:
#   - Lokaal: http://localhost:5000
#   - NAS LAN: http://192.168.1.100:5000
#   - Meerdere: http://192.168.1.100:5000,https://bunq.jouw-domein.nl
ALLOWED_ORIGINS=http://localhost:5000
SESSION_COOKIE_SECURE=false

# ============================================
# FLASK CONFIGURATION
# ============================================

# Flask debug mode (ALTIJD false in productie!)
FLASK_DEBUG=false

# ============================================
# LOGGING
# ============================================

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# ============================================
# PERFORMANCE / CACHE
# ============================================

# Enable in-memory caching for API responses
CACHE_ENABLED=true

# Cache TTL in seconds
CACHE_TTL_SECONDS=60

# Pagination defaults
DEFAULT_PAGE_SIZE=500
MAX_PAGE_SIZE=2000

# Max days allowed for requests (safety cap)
MAX_DAYS=3650

# ============================================
# SESSION CONFIGURATION
# ============================================

# Session lifetime (in hours)
# Default: 24 hours - hardcoded in api_proxy.py
# Gebruikers moeten elke 24 uur opnieuw inloggen

# Session cookie name
# Default: session - Flask default

# ============================================
# DEPLOYMENT NOTES
# ============================================

# INSTALLATIE STAPPEN:
# ====================
#
# 1. Kopieer dit bestand naar .env:
#    cp .env.example .env
#
# 2. Maak Docker secrets (Swarm):
#    printf "YourStrongPassword" | docker secret create bunq_basic_auth_password -
#    python3 -c "import secrets; print(secrets.token_hex(32))" | docker secret create bunq_flask_secret_key -
#    printf "user.xxxx-xxxx-xxxx-xxxx" | docker secret create bunq_vaultwarden_client_id -
#    printf "your_vaultwarden_client_secret" | docker secret create bunq_vaultwarden_client_secret -
#
# 3. Update ALLOWED_ORIGINS met je NAS IP-adres
#
# 4. Als je HTTPS gebruikt (aanbevolen!):
#    SESSION_COOKIE_SECURE=true
#
# 5. Build & deploy (Swarm):
#    docker build -t bunq-dashboard:local .
#    docker stack deploy -c docker-compose.yml bunq
#
# SECURITY CHECKLIST:
# ===================
# ✅ Secret bunq_basic_auth_password ingesteld
# ✅ Secret bunq_flask_secret_key gegenereerd
# ✅ ALLOWED_ORIGINS beperkt tot je NAS/domein
# ✅ FLASK_DEBUG=false in productie
# ✅ Bunq API key in Vaultwarden (niet in .env)
# ✅ SESSION_COOKIE_SECURE=true (als HTTPS)
# ✅ Firewall regels actief
# ✅ Alleen toegang via VPN

# SESSIE BEVEILIGING:
# ===================
# • Credentials worden NOOIT in localStorage opgeslagen
# • Session cookies zijn HttpOnly (niet toegankelijk via JavaScript)
# • Session cookies zijn SameSite=Lax (CSRF bescherming)
# • Sessions verlopen na 24 uur
# • Rate limiting: 5 login pogingen per minuut
# • Logout vernietigt sessie onmiddellijk

# VOOR HTTPS DEPLOYMENT:
# =======================
# 1. Verkrijg SSL certificaat (Let's Encrypt via Synology)
# 2. Configureer reverse proxy met HTTPS
# 3. Set SESSION_COOKIE_SECURE=true
# 4. Update ALLOWED_ORIGINS met https:// URLs

# TROUBLESHOOTING:
# ================
# 
# "Session expired" na container restart?
# → bunq_flask_secret_key secret niet ingesteld - genereer er één!
#
# "CORS error"?
# → Check ALLOWED_ORIGINS bevat je frontend URL
#
# "Login failed"?
# → Controleer BASIC_AUTH_USERNAME en bunq_basic_auth_password secret
#
# "Rate limit exceeded"?
# → Wacht 60 seconden, of herstart container
